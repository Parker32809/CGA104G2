<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Insert title here</title>
    <style>
    	#table1{
    		display: inline-block;
    		border: 1px solid red;
    	}
    	img{
			display: inline-block;
  			width: 15%;
 			height: auto;
		}
		#storeTitle {
			text-align: center;
			background-color:#EDEDED;
			margin-bottom: 10px;
			display: inline-block;
			width: 100%;
		
		}
    </style>
</head>

<body>
	<div id='storeTitle'>

	</div>

    <div id='showOneStore'>
    	<span id='putPhoto'></span>
    	
    	<table id='table1'>
    	</table>
    	
        <div id='map' style='width:25%; height:50vh;'></div>
        
    </div>
</body>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<script src="../../resources/datetimepicker/jquery.js"></script>
	<script src="../../resources/datetimepicker/jquery.datetimepicker.full.js"></script>
	<script src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCWmGpi2QtEbUO5WNVL3xD7UZJiwbUqT_A&libraries=places"></script>

<script>

	let centerLat = 24.9575352;
	let centerLng = 121.2250577;
	let storeLat;
	let storeLng;

	
	window.addEventListener("load",async function () {
		await fetch('../../back-end/store/store.do?action=getOne_For_Display', {
			method: 'get'
		})
		.then(res => res.json())	
		.then(res =>{
			showStore(res);
		})
		
		function showStore(store) {
		storeLat = store[4];
		storeLng = store[5];
        let str = "";
        
        
        str = "<h1>"+store[0]+"</h1>";
        $('#storeTitle').append(str);
        
        str = "<img id='img' src=data:image/jpeg;base64,"+store[3]+">";
        $('#putPhoto').append(str);
        
        str = "<table>"
        +"<tr><td>"+store[1]+"</td></tr>"
        +"<tr><td>"+store[2]+"</td></tr>"
        +"</table>"
        +"<input type='hidden' id='storeLat' value='"+store[4]+"'>"
        +"<input type='hidden' id='storeLon' value='"+store[5]+"'>";
        $('#table1').append(str);   
        map();
    }
	});
	
	

	
	
    function map() {
    	
        // 載入路線服務與路線顯示圖層
        var directionsService = new google.maps.DirectionsService();
        var directionsDisplay = new google.maps.DirectionsRenderer();
        function initMap() { }
        
        // 初始化地圖
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 16,
            center: { lat: parseFloat(centerLat), lng: parseFloat(centerLng) }
        });

        // 放置路線圖層
        directionsDisplay.setMap(map);

        // 路線相關設定(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!改)
        var request = {
            origin: { lat: parseFloat(centerLat), lng: parseFloat(centerLng) },
            destination: { lat: parseFloat(storeLat), lng:  parseFloat(storeLng)},
            travelMode: 'WALKING'
        };

        // 繪製路線
        directionsService.route(request, function (result, status) {
            if (status == 'OK') {
                // 回傳路線上每個步驟的細節
                directionsDisplay.setDirections(result);
            } else {
                console.log(status);
            }
        });
    }

	
    
    
    
	

</script>



</html>